CREATE DATABASE CUSTOMERSALES3;
USE CUSTOMERSALES3;
CREATE TABLE SALESMAN(
Sid VARCHAR(10),
Sname VARCHAR(20) NOT NULL,
City VARCHAR(20) NOT NULL,
Commission VARCHAR(20) NOT NULL,
PRIMARY KEY(Sid)
);
INSERT INTO SALESMAN VALUES(211, 'ANJITHA', 'KOLLAM','5');
INSERT INTO SALESMAN VALUES(212, 'AMRITHA', 'MALAPPURAM','12');
INSERT INTO SALESMAN VALUES(213, 'ANASWARA', 'KOLLAM','15');
INSERT INTO SALESMAN VALUES(214, 'ARCHANA', 'KOTTAYAM','8');
SELECT * FROM SALESMAN;



CREATE TABLE CUSTOMER2(
Cid VARCHAR(10) ,
Cname VARCHAR(20),
City VARCHAR(20),
Grade VARCHAR(20),
Sid VARCHAR(10),
PRIMARY KEY(Cid),
FOREIGN KEY(Sid)REFERENCES SALESMAN(Sid) ON DELETE CASCADE);
INSERT INTO CUSTOMER2 VALUES(311, 'ANJU', 'Changanasseri',100,211);
INSERT INTO CUSTOMER2 VALUES(312, 'Dwany', 'Banglore',90,212);
INSERT INTO CUSTOMER2 VALUES(313, 'Manjari', 'Kasargodu',80,213);
INSERT INTO CUSTOMER2 VALUES(314, 'Manju', 'Mangalapuram',100,214);
select * from customer2;



CREATE TABLE ORDERS (
Ord_No VARCHAR(10) ,
Purchase_Amt INT NOT NULL,
Ord_Date DATE NOT NULL,
Cid VARCHAR(10),
PRIMARY KEY(Ord_No),
FOREIGN KEY(Cid)REFERENCES CUSTOMER2(Cid) ON DELETE CASCADE,
Sid VARCHAR(10),
FOREIGN KEY(Sid)REFERENCES SALESMAN(Sid) ON DELETE CASCADE) ;
INSERT INTO ORDERS VALUES(001, 250, '2022-03-19',314,214);
INSERT INTO ORDERS VALUES(002, 350, '2022-02-09',313,213);
INSERT INTO ORDERS VALUES(003, 550, '2022-03-29',312,212);
INSERT INTO ORDERS VALUES(004, 150, '2022-03-15',311,211);
select * from orders;

SELECT GRADE,COUNT(*) FROM CUSTOMER2 GROUP BY GRADE HAVING GRADE>(SELECT 
AVG(GRADE) FROM CUSTOMER2);


